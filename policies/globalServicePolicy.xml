<!--
    IMPORTANT:
    - Policy elements can appear only within the <inbound>, <outbound>, <backend> section elements.
    - Only the <forward-request> policy element can appear within the <backend> section element.
    - To apply a policy to the incoming request (before it is forwarded to the backend service), place a corresponding policy element within the <inbound> section element.
    - To apply a policy to the outgoing response (before it is sent back to the caller), place a corresponding policy element within the <outbound> section element.
    - To add a policy position the cursor at the desired insertion point and click on the round button associated with the policy.
    - To remove a policy, delete the corresponding policy statement from the policy document.
    - Policies are applied in the order of their appearance, from the top down.
-->
<policies>
	<inbound>
		<cors allow-credentials="true">
			<allowed-origins>
				<origin>https://ce-nonprod-api.developer.azure-api.net</origin>
				<origin>https://flow.microsoft.com</origin>
				<origin>https://us.create.powerapps.com</origin>
				<origin>https://apps.powerapps.com</origin>
			</allowed-origins>
			<allowed-methods preflight-result-max-age="300">
				<method>*</method>
			</allowed-methods>
			<allowed-headers>
				<header>*</header>
			</allowed-headers>
			<expose-headers>
				<header>*</header>
			</expose-headers>
		</cors>
		<check-header name="X-Azure-FDID" failed-check-httpcode="403" failed-check-error-message="" ignore-case="true">
			<value>93385aed-f658-45e0-b7b1-3129551d7974</value>
		</check-header>
		<set-header name="Ocp-Apim-Subscription-Key" exists-action="delete" />
		<ip-filter action="allow">
			<address-range from="13.73.248.17" to="13.73.248.22" />
			<address-range from="20.36.120.105" to="20.36.120.110" />
			<address-range from="20.37.64.105" to="20.37.64.110" />
			<address-range from="20.37.156.121" to="20.37.156.126" />
			<address-range from="20.37.195.1" to="20.37.195.6" />
			<address-range from="20.37.224.105" to="20.37.224.110" />
			<address-range from="20.38.84.73" to="20.38.84.78" />
			<address-range from="20.38.136.105" to="20.38.136.110" />
			<address-range from="20.39.11.9" to="20.39.11.14" />
			<address-range from="20.41.4.89" to="20.41.4.94" />
			<address-range from="20.41.64.121" to="20.41.64.126" />
			<address-range from="20.41.192.105" to="20.41.192.110" />
			<address-range from="20.42.4.121" to="20.42.4.126" />
			<address-range from="20.42.129.153" to="20.42.129.158" />
			<address-range from="20.42.224.105" to="20.42.224.110" />
			<address-range from="20.43.41.137" to="20.43.41.142" />
			<address-range from="20.43.65.129" to="20.43.65.134" />
			<address-range from="20.43.130.81" to="20.43.130.86" />
			<address-range from="20.45.112.105" to="20.45.112.110" />
			<address-range from="20.45.192.105" to="20.45.192.110" />
			<address-range from="20.72.18.249" to="20.72.18.254" />
			<address-range from="20.150.160.97" to="20.150.160.102" />
			<address-range from="20.189.106.113" to="20.189.106.118" />
			<address-range from="20.192.161.105" to="20.192.161.110" />
			<address-range from="20.192.225.49" to="20.192.225.54" />
			<address-range from="40.67.48.105" to="40.67.48.110" />
			<address-range from="40.74.30.73" to="40.74.30.78" />
			<address-range from="40.80.56.105" to="40.80.56.110" />
			<address-range from="40.80.168.105" to="40.80.168.110" />
			<address-range from="40.80.184.121" to="40.80.184.126" />
			<address-range from="40.82.248.249" to="40.82.248.254" />
			<address-range from="40.89.16.105" to="40.89.16.110" />
			<address-range from="51.12.41.9" to="51.12.41.14" />
			<address-range from="51.12.193.9" to="51.12.193.14" />
			<address-range from="51.104.25.129" to="51.104.25.134" />
			<address-range from="51.105.80.105" to="51.105.80.110" />
			<address-range from="51.105.88.105" to="51.105.88.110" />
			<address-range from="51.107.48.105" to="51.107.48.110" />
			<address-range from="51.107.144.105" to="51.107.144.110" />
			<address-range from="51.120.40.105" to="51.120.40.110" />
			<address-range from="51.120.224.105" to="51.120.224.110" />
			<address-range from="51.137.160.113" to="51.137.160.118" />
			<address-range from="51.143.192.105" to="51.143.192.110" />
			<address-range from="52.136.48.105" to="52.136.48.110" />
			<address-range from="52.140.104.105" to="52.140.104.110" />
			<address-range from="52.150.136.121" to="52.150.136.126" />
			<address-range from="52.228.80.121" to="52.228.80.126" />
			<address-range from="102.133.56.89" to="102.133.56.94" />
			<address-range from="102.133.216.89" to="102.133.216.94" />
			<address-range from="147.243.0.1" to="147.243.255.254" />
			<address-range from="191.233.9.121" to="191.233.9.126" />
			<address-range from="191.235.225.129" to="191.235.225.134" />
			<address-range from="67.59.60.0" to="67.59.61.255" />
			<address-range from="146.88.224.0" to="146.88.225.255" />
			<address>13.91.254.72</address>
		</ip-filter>
	</inbound>
	<backend>
		<forward-request />
	</backend>
	<outbound>
		<set-header name="Strict-Transport-Security" exists-action="override">
			<value>max-age=31536000</value>
		</set-header>
		<set-header name="X-XSS-Protection" exists-action="override">
			<value>1; mode=block</value>
		</set-header>
		<set-header name="Content-Security-Policy" exists-action="override">
			<value>script-src 'self'</value>
		</set-header>
		<set-header name="X-Frame-Options" exists-action="override">
			<value>deny</value>
		</set-header>
		<set-header name="X-Content-Type-Options" exists-action="override">
			<value>nosniff</value>
		</set-header>
		<set-header name="Expect-Ct" exists-action="override">
			<value>max-age=604800,enforce</value>
		</set-header>
		<set-header name="Cache-Control" exists-action="override">
			<value>none</value>
		</set-header>
		<set-header name="X-Powered-By" exists-action="delete" />
		<set-header name="X-AspNet-Version" exists-action="delete" />
	</outbound>
	<on-error>
		<set-header name="ErrorSource" exists-action="override">
			<value>@(context.LastError.Source)</value>
		</set-header>
		<set-header name="ErrorReason" exists-action="override">
			<value>@(context.LastError.Reason)</value>
		</set-header>
		<set-header name="ErrorMessage" exists-action="override">
			<value>@(context.LastError.Message)</value>
		</set-header>
		<set-header name="ErrorScope" exists-action="override">
			<value>@(context.LastError.Scope)</value>
		</set-header>
		<set-header name="ErrorSection" exists-action="override">
			<value>@(context.LastError.Section)</value>
		</set-header>
		<set-header name="ErrorPath" exists-action="override">
			<value>@(context.LastError.Path)</value>
		</set-header>
		<set-header name="ErrorPolicyId" exists-action="override">
			<value>@(context.LastError.PolicyId)</value>
		</set-header>
		<set-header name="ErrorStatusCode" exists-action="override">
			<value>@(context.Response.StatusCode.ToString())</value>
		</set-header>
		<set-header name="WWW-Authenticate" exists-action="override">
			<value>@(context.LastError.Reason)</value>
		</set-header>
	</on-error>
</policies>